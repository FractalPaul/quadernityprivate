"use strict";function extractQueryParameters(){var e=getUrlVars();if(e){var t=e.ci;t||(t=e.index),t||(t=e.catindex),t&&(categoryIndex=Number(t))}}function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,a,r){e[a]=r});return e}function initCamera(){camera=null,camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2e3),camera.position.y=400}function drawGeometry(){scene=null,scene=new THREE.Scene;var e=new THREE.AmbientLight(13421772,1.09);scene.add(e),scene.add(camera);var t=new THREE.PointLight(13421772,1,100);t.position.set(-50,300,0),scene.add(t);var a=new THREE.PointLight(16711680,1,100);a.position.set(50,300,0),scene.add(a),drawParametricGeometry(),drawAxis(),showAxis(configParms.drawAxis),loadFont()}function createCatButtons(){for(var e=0;e<categorySets.length;e++)categorySets[e].visible&&createButton(categorySets[e].title,e)}function setupRender(){var e=document.getElementById("container");renderer=null,renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setPixelRatio(window.devicePixelRatio),setDimension(),renderer.setSize(windowWidth,windowHeight),e.appendChild(renderer.domElement),window.addEventListener("resize",onWindowResize,!1),controls=new THREE.OrbitControls(camera,renderer.domElement)}function setDimension(){windowWidth=window.innerWidth-15,windowHeight=window.innerHeight*heightFactor}function onWindowResize(){setDimension(),camera.aspect=1.61,camera.updateProjectionMatrix(),renderer.setSize(windowWidth,windowHeight)}function scaleCamera(){camera.zoom=2,camera.updateProjectionMatrix(),controls.update()}function setTitle(){var e=document.getElementById("qtitle");e.innerText=categorySets[categoryIndex-1].title}function createButton(e,t){var a=document.getElementById("buttoncontainer"),r=document.createElement("input");r.setAttribute("type","button"),r.setAttribute("name","catButton"+t),r.setAttribute("value",e),r.onclick=function(){displayCategory(t)},a.appendChild(r)}function displayCategory(e){categoryIndex=e+1,displayLabels()}function displayLabels(){void 0!==_font?drawText1(_font):loadFont()}function drawAxis(){var e=100,t=new THREE.LineBasicMaterial({color:255}),a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(-e,0,0)),a.vertices.push(new THREE.Vector3(e,0,0));var r=new THREE.Line(a,t);_groupAxis.add(r);var n=new THREE.Geometry;n.vertices.push(new THREE.Vector3(0,0,0)),n.vertices.push(new THREE.Vector3(0,e,0));var o=new THREE.Line(n,new THREE.LineBasicMaterial({color:65535}));_groupAxis.add(o);var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(0,0,0)),i.vertices.push(new THREE.Vector3(0,0,e));var s=new THREE.Line(i,new THREE.LineBasicMaterial({color:16711680}));_groupAxis.add(s),scene.add(_groupAxis)}function showAxis(e){for(var t=0;t<_groupAxis.children.length;t++)_groupAxis.children[t].visible=e}function toggleAxis(){configParms.drawAxis=!configParms.drawAxis,showAxis(configParms.drawAxis)}function animate(){requestAnimationFrame(animate),render()}function render(){renderer.render(scene,camera)}function drawParametricGeometry(){var e,t,a=50,r=18,n=20,o=80,i=0;_matBlueBack=new THREE.MeshStandardMaterial({color:configParms.blueColor,side:THREE.BackSide}),_matBlueFront=new THREE.MeshStandardMaterial({color:configParms.blueColor,side:THREE.FrontSide}),_matGreenFront=new THREE.MeshStandardMaterial({color:configParms.greenColor,side:THREE.FrontSide}),_matGreenBack=new THREE.MeshStandardMaterial({color:configParms.greenColor,side:THREE.BackSide}),_group=null,_group=new THREE.Group,e=new THREE.ParametricBufferGeometry(parametricQuad1,n,o),t=new THREE.Mesh(e,_matBlueBack),t.scale.multiplyScalar(a),t.rotateY(-Math.PI/r),t.translateZ(-i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad1,n,o),t=new THREE.Mesh(e,_matGreenFront),t.scale.multiplyScalar(a),t.rotateY(-Math.PI/r),t.translateZ(-i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad2,n,o),t=new THREE.Mesh(e,_matGreenBack),t.scale.multiplyScalar(a),t.rotateY(-Math.PI/r),t.translateZ(-i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad2,n,o),t=new THREE.Mesh(e,_matBlueFront),t.scale.multiplyScalar(a),t.rotateY(-Math.PI/r),t.translateZ(-i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad3,n,o),t=new THREE.Mesh(e,_matBlueBack),t.scale.multiplyScalar(a),t.rotateY(Math.PI/r),t.translateZ(i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad3,n,o),t=new THREE.Mesh(e,_matGreenFront),t.scale.multiplyScalar(a),t.rotateY(Math.PI/r),t.translateZ(i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad4,n,o),t=new THREE.Mesh(e,_matBlueFront),t.scale.multiplyScalar(a),t.rotateY(Math.PI/r),t.translateZ(i),_group.add(t),e=new THREE.ParametricBufferGeometry(parametricQuad4,n,o),t=new THREE.Mesh(e,_matGreenBack),t.scale.multiplyScalar(a),t.rotateY(Math.PI/r),t.translateZ(i),_group.add(t),scene.add(_group),_group.rotateX(Math.PI/2),_group.rotateY(Math.PI/2),_group.translateX(a)}function setBlueColor(e){_matBlueBack.color.set(e),_matBlueFront.color.set(e)}function setGreenColor(e){_matGreenBack.color.set(e),_matGreenFront.color.set(e)}function loadFont(){var e=new THREE.FontLoader;_font=e.parse(fontJSON)}function makeGroupVisible(e,t){for(var a=0;a<e.children.length;a++)e.children[a].visible=t}function drawText1(e){setTitle();var t=[];_matText=[],_geoText=[],void 0!==_groupText1&&scene.remove(_groupText1),_groupText1=new THREE.Group;for(var a=0;a<categorySets[categoryIndex-1].positions.length;a++)t=extractLabels(categorySets[categoryIndex-1].positions[a].labels),drawTextPos(e,categorySets[categoryIndex-1].positions[a],_fontColorYellow,t,a,_groupText1);scene.add(_groupText1)}function extractLabels(e){var t=[],a="";if(null!=e)for(var r=0;r<e.length;r++)a=e[r].trim(),a.length>0&&(r<configParms.maxLines||t.length<configParms.maxLines)&&t.push(a);return t}function drawTextPos(e,t,a,r,n,o){for(var i=0;i<r.length;i++){var s=new THREE.TextBufferGeometry(r[i],{font:e,size:t.fontsize,height:.2,curveSegments:12,bevelEnabled:!1,bevelThickness:1,bevelSize:1,bevelSegments:1});s.computeBoundingBox(),s.computeVertexNormals();var c=.5*(s.boundingBox.max.x-s.boundingBox.min.x),l=new THREE.MeshBasicMaterial({color:a,flatShading:!0});_matText.push(l),_geoText.push(s);var u=new THREE.Mesh(s,l),d=n,m=posParms[d].vec[0],f=posParms[d].vec[1],p=posParms[d].vec[2],g=posParms[d].offset;u.position.x=g[0]*c+m+t.xOffset,u.position.y=g[1]*c+f+t.yOffset,u.position.z=g[2]*c+p+t.zOffset;var E=calcOffset(r.length,i,n);0!=g[2]?u.position.y-=1.5*E*t.fontsize:0!=g[1]?u.position.z-=1.5*E*t.fontsize:0!=g[0]?u.position.y-=1.5*E*t.fontsize:u.position.y-=1.5*posoffset*t.fontsize,u.rotation.x=posParms[d].rot[0],u.rotation.y=posParms[d].rot[1],u.rotation.z=posParms[d].rot[2],u.visible=!0,o.add(u)}}function calcOffset(e,t,a){if(1==e||1===e)return 6==a||6===a?-.3:2==a||2===a?.4:3==a||3===a||5==a||5===a?0:.3;var r=0;return r=2==a||2===a?e/2-t+.3:5==a||5===a?e/2-t-.3:6==a||6===a?t-e/2-.3:3==a||3===a?t-e/2:t-e/2+.9,r}function areEqual(e,t){return e==t||e===t}function parametricQuad1(e,t,a){var r,n,o,i=t*configParms.endAngleB*Math.PI;n=t*TWOPI*paraFunc1(e),r=configParms.ellipseALen*paraFunc2(i),o=configParms.ellipseBLen*paraFunc3(i)-configParms.xOffset,r-=1,a.set(r,n,o)}function parametricQuad2(e,t,a){var r,n,o,i=t*configParms.endAngleB*Math.PI;n=-t*TWOPI*paraFunc1(e),r=configParms.ellipseALen*paraFunc2(i),o=configParms.ellipseBLen*paraFunc3(i)-configParms.xOffset,r-=1,a.set(r,n,o)}function parametricQuad3(e,t,a){var r,n,o,i=t*configParms.endAngleB*Math.PI;n=t*TWOPI*paraFunc1(e),r=configParms.ellipseALen*paraFunc2(i),o=-configParms.ellipseBLen*paraFunc3(i)+configParms.xOffset,r-=1,a.set(r,n,o)}function parametricQuad4(e,t,a){var r,n,o,i=t*configParms.endAngleB*Math.PI;n=-t*TWOPI*paraFunc1(e),r=configParms.ellipseALen*paraFunc2(i),o=-configParms.ellipseBLen*paraFunc3(i)+configParms.xOffset,r-=1,a.set(r,n,o)}function paraFunc1(e){return e/6}function paraFunc3(e){return configParms.cfa*Math.sin(e+configParms.osb)-Math.cos(e+configParms.osb)}function paraFunc2(e){return configParms.cfb*Math.sin(e+configParms.osa)}var camera,scene,renderer,stats,controls;!1===WEBGL.isWebGLAvailable()&&document.body.appendChild(WEBGL.getWebGLErrorMessage());var _matBlueBack,_matBlueFront,_matGreenFront,_matGreenBack,_font,heightFactor=.9,windowWidth=0,windowHeight=0,_groupAxis=new THREE.Group,_groupText1=new THREE.Group,_fontColorYellow=13097278,_fontColorWhite=16777215,_group=new THREE.Group,_matText=[],_geoText=[],_largeFontSize=9,_smallFontSize=7,configParms={cfa:.92,cfb:.92,osb:1.25,osa:1.9,xOffset:.4,ellipseBLen:.7,ellipseALen:1.2,endAngleB:1.85,drawAxis:!1,blueColor:2047956,greenColor:576811,maxLines:5},TWOPI=2*Math.PI,PIhalf=Math.PI/2,posParms=[{id:1,name:"Left Large Outside Green",vec:[-80,0,0],rot:[0,-PIhalf,0],offset:[0,0,-1]},{id:2,name:"Left Large Outside Blue",vec:[-70,0,0],rot:[0,PIhalf,0],offset:[0,0,1]},{id:3,name:"Left Small Outside Blue",vec:[-23,0,3.5],rot:[0,-PIhalf,PIhalf],offset:[0,-1,0]},{id:4,name:"Left Small Inside Green",vec:[-13,0,-2],rot:[PIhalf,PIhalf,0],offset:[0,-1,0]},{id:5,name:"Bottom",vec:[0,-65,0],rot:[0,0,0],offset:[-1,0,0]},{id:6,name:"Right Small Inside Blue",vec:[13,0,2],rot:[-PIhalf,-PIhalf,0],offset:[0,-1,0]},{id:7,name:"Right Small Outside Green",vec:[23,0,-3.5],rot:[0,PIhalf,PIhalf],offset:[0,-1,0]},{id:8,name:"Right Large Inside Green",vec:[70,0,0],rot:[0,-PIhalf,0],offset:[0,0,-1]},{id:9,name:"Left Large Outside Blue",vec:[80,0,1],rot:[0,PIhalf,0],offset:[0,0,1]},{id:10,name:"Top",vec:[0,75,0],rot:[0,0,0],offset:[-1,0,0]}],fontJSON="";extractQueryParameters(),createCatButtons(),initCamera(),drawGeometry(),setupRender(),scaleCamera(),displayCategory(0),animate();